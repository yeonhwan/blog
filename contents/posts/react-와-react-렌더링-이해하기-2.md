---
title: React 와 렌더링(2) - 동시성 렌더링
excerpt: React의 동시성 렌더링 이해하기
date: 2025-05-30T06:44:08.296Z
publish: false
slug: react-와-react-렌더링-이해하기-2
tags: [React, UI]
---


## Concurrent Rendering

React의 `동시성 렌더링(Concurrent Rendering)`은 이러한 Fiber 아키텍처를 활용해 렌더링 작업을 더 작은 단위로 분할하고
여러 작업 간의 우선순위를 유동적으로 조정하여 필요에 따라 작업을 일시 중지하고 재개할 수 있는 방법을 말한다.

그러나 단순히 이 설명을 통해서는 왜 `동시성`이라는 표현이 사용되었는지 직감적으로 와닿지는 않는다.
이 작업이 `동시성 렌더링` 이라고 불려지는 이유는 이를 달성하기 위한 내부적인 기법에 존재한다.


### 타임 슬라이싱(Time slicing)

`타임 슬라이싱(Time Slicing, 시분할) 기법`이란, 단일 스레드(Single Thread) 환경에서 주어진 시간 조각(time slice) 내에서만 작업을 수행하고,
시간이 끝나면 다음 작업으로 전환하거나 호스트환경에 제어권을 넘겨주는 방식을 말한다. 

이는 예약된 여러 작업들을 각각 동기식으로 한 번에 진행하고 완료하는 대신,
짧은 시간 동안 여러 작업을 번갈아가며(동시적으로) 수행하여 전체 시스템의 반응성과 효율성을 도모하는 방법이다.

시분할 기법을 사용함으로써 얻을 수 있는 이점은 다음과 같다.

- 여러 작업을 동시적으로 처리하여 다수의 작업이 같이 처리되는 효과를 얻을 수 있다. 
- 작업들의 우선순위를 유동적으로 조절하여 우선순위가 높은 작업을 먼저 처리하되, 낮은 우선순위의 작업도 완전히 차단하지 않고 진행할 수 있다.
- 작업을 작은 단위로 분할하여 짧은 시간 동안만 실행하기 때문에, 호스트 환경의 필요시 작업을 중지하고 제어권을 넘겨줄 수 있다.



### 자바스크립트와 비동기 

먼저 타임슬라이싱을 자바스크립트 환경위에서 이해해보자.

자바스크립트는 싱글스레드 언어로 모든 작업이 동기적으로 작동한다.  
하지만 우리는 호스트 환경의 스레드와 이벤트 루프를 통해서 비동기적인 작업을 진행할 수 있다. 

브라우저를 기준으로 자바스크립트의 작업들은 크게 다음과 같이 분류할 수 있다.

1. 동기적 작업

동기적으로 실행되도록 작성된 모든 작업들을 말하며, 해당 작업들은 콜 스택(Call Stack)의 호출 순서대로 작업된다.
이 작업들이 진행되는 동안(즉, 콜 스택이 비워질 때까지)에는 다른 작업들(비동기 작업 포함)이 실행될 수 없다.
긴 동기적인 작업은 완료될 때까지 다른 모든 작업들을 멈추게 할 수 있다.

2. 마이크로 태스크

비동기적인 작업들 중 처리 우선순위가 높아 호스트환경에서 모든 동기적 작업이 완료된 직후 바로 실행되는 작업들이다.
해당 작업이 완료될 때까지, 매크로 태스크와 브라우저의 렌더링 작업은 대기한다. 


3. 매크로 태스크:

비동기적인 작업들 중 낮은 처리 우선순위를 가진 작업들을 말한다.
매크로 태스크는 동기적 작업과 마이크로태스크가 완료된 이후 작업이 시작된다.
각 매크로 태스크가 실행된 후에는 브라우저의 렌더링이나 이벤트 처리와 같은 다른 중요한 작업이 수행될 기회를 얻는다.

<br/>

각각의 태스크는 다음과 같은 작업 순서를 가진다.


```
1. 동기적 작업 실행
        | 
2. 콜스택이 비워짐
        | 
3. 모든 마이크로 태스크 실행
        |
4. 등록된 하나의 매크로 태스크 실행 
        |
5. 호스트 환경이 다시 주도권을 얻어 필요한 작업들을 실행
        |
6. 유휴 시간이 발생하면 다시 태스크 큐를 확인
```

브라우저 환경에서의 타임슬라이싱은 해당 작업들을 통해 다음과 같이 이루어질 수 있다.

1. 작업 전환의 기준이 될 시간 제한을 지정한다.
2. 필요한 작업을 비동기적(매크로태스크)으로 스케쥴링한다.
3. 브라우저가 유휴시간이 생기면 스케쥴링된 작업을 실행한다.
4. 작업 시간을 판단하여, 시간의 기준을 초과하면 작업을 중단하고,
다음 작업을 스케쥴링한뒤, 브라우저에게 다시 주도권을 넘긴다.
5. 브라우저는 렌더링과 이벤트 실행등 필요한 작업들과 사이에 추가된 작업들을 실행한다.
6. 다시 브라우저가 유휴시간을 얻으면 예약된 작업을 실행한다.


마이크로 태스크의 경우 높은 우선순위를 가지기 때문에 파악되는 모든 마이크로 태스크 작업을 처리하는 것을
목적으로 한다. 만약, 마이크로 태스크가 새로운 마이크로 태스크를 등록한다면 해당 마이크로 태스크 또한 
이번 작업 싸이클에 처리되어야 할 작업으로 인식되는 것이다.

따라서 타임슬라이싱에서의 작업 예약은 브라우저에게 주도권을 넘겨줄 수 있는 매크로 태스크를 통해 처리된다.

### React Scheduler

React 의 내부에서는 `스케줄러(React Scheduler)` 패키지가 작업을 예약하고 타이밍관련 기능을 처리하는 역할을 한다.  

React 가 타임 슬라이싱을 통해 React 렌더링을 처리하는 방식도 크게 다르지는 않다.
